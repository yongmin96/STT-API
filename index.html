<!DOCTYPE html>
<!-- <html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Portfolio</title>
</head>
<body>
  <p>Hello, ISPL</p>
</body>
</html>
 -->

<html> 
<head> 
	<meta charset="utf-8"> 
	<title>Speech to Text</title> 
	<style> 
		body{
			text-align: center; 
		}
		button{ 
			padding: 8px; 
			/*border-radius: 6px;*/ 
		} 
		#message { 
			color: #996600; 
		}
		.textWrapper{ 
			width: 800px; 
			margin: 0 auto; 
			display: flex; 
			flex-direction: row; 
		} 
		.textbox{ 
			height: 100px; 
			border: 1px solid #d3d3d3; 
			flex: 1; 
			margin : 5px 15px; 
			border-radius: 6px; 
			text-align: left; 
			padding: 16px; 
		}
	</style> 
</head> 
<body>

Speech to Text Example!!!
	
	<button id="speech" onclick="speech_to_text()">Start STT</button> 
	<button id="stop" onclick="stop()">Stop</button> 
	
버튼을 누르고 아무말이나 하세요.
	
	<script type="text/javascript">
		var message = document.querySelector("#message"); 
		var button = document.querySelector("#speech"); 
		var korea = document.querySelector("#korea"); 
		var english = document.querySelector("#english"); 
		var isRecognizing = false;
		if ('SpeechRecognition' in window) {
			// Speech recognition support. Talk to your apps!
			console.log("음성인식을 지원하는 브라우저입니다.") 
		}
		try { 
			var recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition || window.mozSpeechRecognition || window.msSpeechRecognition)(); 
		} 
		catch(e){ 
			console.error(e); 
		}
		recognition.lang = 'ko-KR'; //선택하게 해줘야 할듯 . 
		recognition.interimResults = false; 
		recognition.maxAlternatives = 5; 
		//recognition.continuous = true;

		function speech_to_text(){ 
			recognition.start(); 
			isRecognizing = true;
			recognition.onstart = function(){
				console.log("음성인식이 시작 되었습니다. 이제 마이크에 무슨 말이든 하세요.");
				message.innerHTML = "음성인식 시작..."; 
				button.innerHTML = "Listening..."; 
				button.disabled = true; 
			}
			
			recognition.onspeechend = function(){
				message.innerHTML = "버튼을 누르고 아무말이나 하세요.";
				button.disabled = false;
				button.innerHTML = "Start STT"; 
			}
            
			recognition.onresult = function(event) {
				console.log('You said: ', event.results[0][0].transcript);
				// 결과를 출력
				var resText = event.results[0][0].transcript;
				korea.innerHTML = resText;
				//text to sppech 
				text_to_speech(resText); 
			};
            
			recognition.onend = function(){ 
				message.innerHTML = "버튼을 누르고 아무말이나 하세요.";
				button.disabled = false;
				button.innerHTML = "Start STT";
				isRecognizing = false;
			}
		}
		
		function stop(){
			recognition.stop();
			message.innerHTML = "버튼을 누르고 아무말이나 하세요.";
			button.disabled = false;
			button.innerHTML = "Start STT";
			isRecognizing = false;
		}
	</script>
</body> 
</html>
